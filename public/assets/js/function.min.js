var commonMethod={showAlert:function(a,b){myApp.swal({title:"",html:a,type:"warning",timer:2500,showCancelButton:false,confirmButtonClass:"btn-danger",confirmButtonText:"OK"}).then(function(c){console.log(c);if(b){b()}})},showSuccess:function(a,b){myApp.swal({title:"",html:a,type:"success",timer:2500,showCancelButton:false,confirmButtonClass:"btn-success",confirmButtonText:"OK"}).then(function(c){console.log(c);if(b){b()}})},showConfirm:function(a,b){myApp.swal({title:"",html:a,type:"warning",showCancelButton:true,confirmButtonClass:"btn-danger",confirmButtonText:"OK"}).then(function(c){console.log(c);if(b){b()}})},validateEmptyText:function(a){return(!a||0===a.length)},validatePhoneNo:function(b){var a=false;b=b.replace("(+84)","0");b=b.replace("+84","0");b=b.replace("0084","0");b=b.replace(/ /g,"");if(b!=""){var c=b.substring(0,2);if((c=="09"||c=="03"||c=="07"||c=="08")&&b.length==10){if(b.match(/^\d{10}/)){a=true}}else{if(c=="01"&&b.length==11){if(b.match(/^\d{11}/)){a=true}}}}return a},validateEmail:function(a){var b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)}};var VusFunc={init:function(){VusFunc.common()},common:function(){$(document).on("submit","#form__consult__register__popup",function(a){a.preventDefault();VusFunc.submitConsultRegistration("form__consult__register__popup")});$(document).on("submit","#form__consult__register",function(a){a.preventDefault();VusFunc.submitConsultRegistration("form__consult__register")});$(document).on("change",".student-corner .filter-block__dropdown select",function(){var b=$("#select__year").val();var a=$("#select__program").val();var c=$("#select__score").val();window.location.href=location.protocol+"//"+location.host+location.pathname+"?year="+b+"&prog="+a+"&score="+c});$(document).on("change",".student-articles .filter-block__dropdown select",function(){var b=$("#select__year").val();var a=$("#select__stage").val();window.location.href=location.protocol+"//"+location.host+location.pathname+"?year="+b+"&stage="+a});$(document).on("change","#select__category",function(){var a=$(this).val();window.location.href=location.protocol+"//"+location.host+location.pathname+"?category="+a});$(document).on("change",".news-filter__mobile select",function(){var a=$(".news-filter__mobile select option:selected").data("type");window.location.href=location.protocol+"//"+location.host+location.pathname+"?type="+a})},loadProvince:function(d){var c=$(".select-city");var a=$(".course-tool__location .custom-scroll");var b=$("#txtCity").data("text-select");if(c.length>0){$.ajax({type:"POST",url:"https://student-api.vus.edu.vn/GetProvince",data:{},cache:false,dataType:"json",async:true,success:function(e){if(e&&e.StatusCode===1){var f=(e.Data)||[];if(f.length>0){c.empty();c.append('<option value="">'+b+"*</option>");a.empty();$.each(f,function(g,h){c.append('<option value="'+h.Value+'">'+h.Name+"</option>");a.append('<li class="" data-value="'+h.Name+'"><span class="text">'+h.Name+"</span></li>")});if(typeof d==="function"){d()}}else{if(typeof d==="function"){d()}}}else{if(typeof d==="function"){d()}}},error:function(e){console.log("Error : ",e);if(typeof d==="function"){d()}}})}else{if(typeof d==="function"){d()}}},submitConsultRegistration:function(z){var e=$("#"+z+" button[type=submit]");e.children("span").html("PLEASE WAIT");var A=$("#"+z);var r=$("#"+z+" .txtFullname");var k=$("#"+z+" .txtDateofBirth");var j=$("#"+z+" .txtContactName");var x=$("#"+z+" .select-city");var c=$("#"+z+" .txtEmail");var q=$("#"+z+" .txtPhone");var m=$("#"+z+" .nhucauhoc");var w=$("#"+z+" .txtNote");var u=$("#"+z+" input[name=source_block]").val();var t=$("#hdLangID").val();var s=r.val();var i=k.val();var d=j.val();var B=x.val();var h=$("#"+z+" .select-city option:selected").text();var v=c.val();var o=q.val().replace(/\s+/ig,"");if(m.val()!=""){var p=m.val()+" - "+w.val()}else{var p=w.val()}var y=$("#hdUTMSource").val();var b=$("#hdUTMCampaign").val();var l=$("#hdUTMMedium").val();var n=$("#hdPrevURL").val();var a=$("#hdUserAgent").val();var f=$("#hdSessionUTM").val();var g=$("#hdPage").val();if(commonMethod.validateEmptyText(s)){commonMethod.showAlert(r.data("text-required"),function(){r.focus()});e.children("span").html(e.attr("data-title"));return false}if(commonMethod.validateEmptyText(i)){commonMethod.showAlert(k.data("text-required"),function(){k.focus()});e.children("span").html(e.attr("data-title"));return false}if(commonMethod.validateEmptyText(B)){commonMethod.showAlert(x.data("text-required"),function(){x.focus()});e.children("span").html(e.attr("data-title"));return false}if(!commonMethod.validateEmail(v)){commonMethod.showAlert(c.data("text-invalid"),function(){c.focus()});e.children("span").html(e.attr("data-title"));return false}if(commonMethod.validateEmptyText(o)){commonMethod.showAlert(q.data("text-required"),function(){q.focus()});e.children("span").html(e.attr("data-title"));return false}if(!commonMethod.validatePhoneNo(o)){commonMethod.showAlert(q.data("text-invalid"),function(){q.focus()});e.children("span").html(e.attr("data-title"));return false}e.prop("disabled",true);setTimeout(function(){e.prop("disabled",false);e.children("span").html(e.attr("data-title"));A[0].reset();setTimeout(function(){window.location="https://vus.edu.vn/thank-you/?TYID=1"},100)},2000);return true},searchTool:function(){var j=["4-6","6-11","11-15","15-18","18-22","22"];var c=[[],[],["lay-chung-chi-quoc-te","ren-luyen-ky-nang"],["lay-chung-chi-quoc-te","hoc-can-ban-mat-goc","nhu-cau-giao-tiep"]];var i=$(".course-tool__age .result").attr("data-value");var d=$(".course-tool__age").attr("data-required");var g=$(".course-tool__need .result").attr("data-value");var f=$(".course-tool__need").attr("data-required");var h=$(".course-tool__location .result").attr("data-value");var b=$(".course-tool__time .result").attr("data-value");var a=$(".course-tool__budget .result").attr("data-value");if(!i){commonMethod.showAlert(d,function(){});return false}if(!g&&i&&i!="4-6"&&i!="6-11"){commonMethod.showAlert(f,function(){});return false}$(".popup__search-detail input[name=location]").val(h);$(".popup__search-detail input[name=timeclass]").val(b);$(".popup__search-detail input[name=budget]").val(a);$(".popup__search-detail input[name=need]").val(g);$(".popup__search-detail input[name=age]").val(i);var e="";if(i=="4-6"){e="1168"}else{if(i=="6-11"){e="1220"}else{if(i=="11-15"||i=="15-18"||i=="18-22"||i=="22"){if(g=="chung-chi-quoc-te"){e="1311"}else{if(g=="ren-luyen-ky-nang"){e="1293"}else{if(g=="hoc-can-ban-mat-goc"){e="1344"}else{if(g=="nhu-cau-giao-tiep"){e="1345"}}}}}}}console.log(e);$(".popup__search-result .popup__search-detail").addClass("hidden");$(".popup__search-result .popup__search-detail-"+e).removeClass("hidden");if(h){$(".search-detail__icons--location").removeClass("hidden");$(".search-detail__icons--location p").text(h)}else{$(".search-detail__icons--location").addClass("hidden")}if(b){$(".search-detail__icons--time").removeClass("hidden");$(".search-detail__icons--time p").text(b)}else{$(".search-detail__icons--time").addClass("hidden")}if(a){$(".search-detail__icons--budget").removeClass("hidden");$(".search-detail__icons--budget p").text(a)}else{$(".search-detail__icons--budget").addClass("hidden")}myApp.openPopup(".popup__search")},submitSearchRegister:function(e){var b=$(".popup__search-detail input[name=location]").val();var a=$(".popup__search-detail input[name=timeclass]").val();var r=$(".popup__search-detail input[name=budget]").val();var j=$(".popup__search-detail input[name=need]").val();var l=$(".popup__search-detail input[name=age]").val();var o=e.find("input[name=fullname]").val();var n=e.find("input[name=email]").val();var g=e.find("input[name=phone]").val();var q=e.find("input[name=near_by]").val();var m=e.find("input[name=courseName]").val();var p=$("#hdLangID").val();var s=$("#hdUTMSource").val();var d=$("#hdUTMCampaign").val();var i=$("#hdUTMMedium").val();var k=$("#hdPrevURL").val();var c=$("#hdUserAgent").val();var f=$("#hdSessionUTM").val();var h=$("#hdPage").val();if(commonMethod.validateEmptyText(o)){commonMethod.showAlert(e.find("input[name=fullname]").data("text-required"),function(){e.find("input[name=fullname]").focus()});return false}if(commonMethod.validateEmptyText(g)){commonMethod.showAlert(e.find("input[name=phone]").data("text-required"),function(){e.find("input[name=phone]").focus()});return false}if(!commonMethod.validatePhoneNo(g)){commonMethod.showAlert(e.find("input[name=phone]").data("text-invalid"),function(){e.find("input[name=phone]").focus()});return false}if(!commonMethod.validateEmail(n)){commonMethod.showAlert(e.find("input[name=email]").data("text-invalid"),function(){e.find("input[name=email]").focus()});return false}$.ajax({type:"POST",url:"/Umbraco/Surface/ConsultRegister/SearchToolRegister",data:{langID:p,fullname:o,phone:g,email:n,near_by:q,location:b,timeclass:a,budget:r,need:j,age:l,courseName:m,pageName:h,UTMSource:s,UTMCamp:d,UTMMedium:i,PrevURL:k,UserAgent:c,SessionUTM:f},cache:false,dataType:"json",async:false,success:function(t){console.log(t);if(t.StatusCode==1){var u=t.APIURL;var v=t.CallApi;if(v=="true"){$.ajax({type:"GET",url:u,success:function(){console.log("call VUS API success")},error:function(){console.log("call VUS API failed")}})}e[0].reset();setTimeout(function(){window.location.href="https://vus.edu.vn/thank-you/?TYID=1"},1000);commonMethod.showSuccess(t.Message,function(){$(".popup.active .popup__exit").click()})}else{if(t.StatusCode==2){e.find("input[name=fullname]").val("");e.find("input[name=email]").val("");e.find("input[name=phone]").val("");e.find("input[name=near_by]").val("");commonMethod.showSuccess(t.Message,function(){$(".popup.active .popup__exit").click()})}else{commonMethod.showAlert(t.Message,function(){})}}},error:function(t){console.log(t)}});return false},setBlock:function(a){$("#form__consult__register__popup input[name=source_block]").val(a)}};function setCookie(a,b,e){var c=new Date();c.setTime(c.getTime()+24*60*60*1000*e);document.cookie=a+"="+b+";path=/;expires="+c.toGMTString()}function getCookie(b){var a=document.cookie.match("(^|;) ?"+b+"=([^;]*)(;|$)");return a?a[2]:null}$(document).ready(function(){VusFunc.init();$search_bar=$(".search-campus");if($search_bar.is(":visible")){$(window).on("scroll",function(){var c=$(this);$top=c.scrollTop();if($top>100){$search_bar.addClass("sticky")}else{$search_bar.removeClass("sticky")}})}$(".top-banner-slide").css({height:($("img:visible",$(".top-banner-slide")).height())+"px"});$(window).on("resize",function(){$(".top-banner-slide").css({height:($("img:visible",$(".top-banner-slide")).height())+"px"})});var b=$("div.map_google");if(b.is(":visible")){$Latitude=$("div#map_google",b).attr("data-latitude");$Longitude=$("div#map_google",b).attr("data-longitude");$content=$("div#map_google",b).attr("data-content");$("div#map_google",b).gMap({zoom:16,markers:[{icon:{image:"/Assets/images/maker.png",iconsize:[37,51],iconanchor:[18,46]},latitude:$Latitude,longitude:$Longitude,popup:true,html:$content}]})}var a=window.location.href;if(a.lastIndexOf("#dangkytuvan")!=-1){$.scrollTo("section.contact-signup",500)}$ul_timkhoahoc=$("ul.timkhoahoc");$ul_timkhoahoc.on("click","li",function(c){c.preventDefault();var d=$(this);d.addClass("selected");document.ConsultForm.hidden_link.value=d.attr("data-link");document.ConsultForm.hidden_child.value=d.attr("data-child");document.ConsultForm.hidden_khoahoc.value=d.attr("data-value");document.ConsultForm.hidden_doituong.value=d.attr("data-target");$("div.timkhoahoc").slideUp(200);$("div."+d.attr("data-target")).slideDown(300,function(){$.scrollTo($("div.timkhoahoc"),400);$(this).css({height:"auto"})})});$ul_nhucauhoc=$("ul.nhucauhoc");$ul_nhucauhoc.on("click","li",function(d){d.preventDefault();var f=$(this);var e=f.parent("ul").parent(".container");if(!f.hasClass("selected")){f.addClass("selected")}else{f.removeClass("selected")}var c="";$listchon=$("li.selected",e);$.each($listchon,function(h,g){c+=$(this).attr("data-value")+","});c=c.replace(/[\,\s]+$/ig,"");document.ConsultForm.hidden_nhucau.value=c});$(".tiep_theo").on("click",function(c){c.preventDefault();var d=$(this);if(document.ConsultForm.hidden_nhucau.value==""){alert("Vui lòng chọn ít nhất một nhu cầu học");return false}$("div.nhucauhoc:visible").slideUp(200);$("div.thongtinhocvien").slideDown(300,function(){$.scrollTo($("div.timkhoahoc"),400);$(this).css({height:"auto"})})});$("select.hocphichuongtrinh").on("change",function(){var d=$(this);var c=d.parent("div.col2").parent(".inside");$("img:first",c).animate({opacity:0.25},300,function(){$(this).attr("src",$("option:selected",d).attr("data-img")).animate({opacity:1},100);$("input.UserNote",$("form#formhocphivus")).val("Nhận thông tin học phí khóa học: "+$("option:selected",d).text())})});if($("select.hocphichuongtrinh").is(":visible")){$("select.hocphichuongtrinh").trigger("change")}$("form#formhocphivus").on("submit",function(c){c.preventDefault();var d=$(this);$("input#butt_submit_register",d).prop("disabled",true).val("PLEASE WAIT");setTimeout(function(){$("input#butt_submit_register",d).prop("disabled",false);$("input#butt_submit_register",d).val($("input#butt_submit_register",d).attr("data-title"));$("form#formhocphivus").html("<p style='text-align:left;font-size:18px;color:#f00'>Cám ơn bạn đã liên hệ</p>");setTimeout(function(){window.location="https://vus.edu.vn/thank-you/?TYID=1"},100)},2000)});$("select#City",$("form#formhocphivus")).on("change",function(){var d=$(this);var c=d.children("option");$.each(c,function(f,e){if($(this).is(":selected")){if($(this).attr("data-city")!=null){$("input#CityName",$("form#formhocphivus")).val($(this).attr("data-city"))}}})});$("#ConsultForm").on("submit",function(c){c.preventDefault();var d=$(this);document.ConsultForm.UserNote.value=document.ConsultForm.UserNote_tmp.value+"\n"+document.ConsultForm.hidden_doituong.value.toUpperCase()+"\n"+document.ConsultForm.hidden_khoahoc.value+"\n"+document.ConsultForm.hidden_nhucau.value;$("#ConsultSubmitBtn").val("PLEASE WAIT").prop("disabled",true);setTimeout(function(){$("#ConsultForm")[0].reset();if(document.ConsultForm.hidden_child.value!=null&&document.ConsultForm.hidden_child.value!=""){$("div.thongtinhocvien:visible").slideUp(200);$("div.khoahocphuhopvoiban").slideDown(300,function(){$(this).css({height:"auto"});$("div.courses__item[data-rel="+document.ConsultForm.hidden_child.value+"]").css({display:"block"})});$("iframe#iframe-findcourse").attr("src","https://vus.edu.vn/thank-you/?TYID=1")}else{window.location="https://vus.edu.vn/";return false}$("#ConsultSubmitBtn").prop("disabled",false);$("#ConsultSubmitBtn").val("Xem kết quả")},2000)})});function IsValidEmail(a){var b=/^([a-zA-Z0-9_\.\-])+@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return b.test(a)}function isEmail(a){return IsValidEmail(a)}String.prototype.trim=function(){return this.replace(/^\s+|\s+$/ig,"")};String.prototype.ltrim=function(){return this.replace(/^\s+/ig,"")};String.prototype.rtrim=function(){return this.replace(/\s+$/ig,"")};function isPhone(a){var b=["12345678","11111111"];a=a.trim();if(a==null||a.length<7){return false}for($index in b){if(a==b[$index]){return false}}return/^(\+84[\-\.])?[0-9]{8,12}/ig.test(a)}function CheckForm($formname){var form=eval("document."+$formname);form.Phone.value=form.Phone.value.replace(/\s+/ig,"");if(form.Fullname.value.length<1){alert("Vui lòng nhập Họ và tên");form.Fullname.focus();return false}if(form.City.value.length<1){alert("Vui lòng chọn tỉnh thành");form.City.focus();return false}if(form.ContactName.value.length<1&&$("#ContactName").is(":visible")){alert("Vui lòng nhập Họ tên phụ huynh");form.ContactName.focus();return false}if(form.CoursePlace.value.length<1){alert("Vui lòng chọn Cơ sở VUS gần bạn");form.CoursePlace.focus();return false}if(form.Email.value.length>0&&!IsValidEmail(form.Email.value)){form.Email.value=""}if(form.City.value.length<1){alert("Vui lòng chọn Tỉnh/Thành");form.City.focus();return false}if(form.Phone.value.length<1){alert("Vui lòng nhập Số điện thoại");form.Phone.select();return false}else{if(!isPhone(form.Phone.value)){alert("Số điện thoại không hợp lệ");form.Phone.focus();return false}}return true};